<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bird Tracking & Registration</title>
<style>
    :root {
        --bg-color: #f4f4f4;
        --text-color: #333;
        --header-bg: #333;
        --header-text: white;
        --card-bg: white;
        --accent: #ff9800;
    }
    body.dark {
        --bg-color: #121212;
        --text-color: #f4f4f4;
        --header-bg: #222;
        --header-text: #ffcc00;
        --card-bg: #1e1e1e;
        --accent: #ff9800;
    }
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        background-color: var(--bg-color);
        color: var(--text-color);
        transition: background-color 0.4s, color 0.4s;
    }
    header {
        background: var(--header-bg);
        color: var(--header-text);
        padding: 15px 0;
        text-align: center;
        position: sticky;
        top: 0;
        z-index: 1000;
    }
    nav {
        display: flex;
        justify-content: center;
        gap: 20px;
        margin-top: 10px;
        flex-wrap: wrap;
    }
    nav a {
        color: var(--header-text);
        text-decoration: none;
        font-weight: bold;
    }
    nav a:hover {
        text-decoration: underline;
    }
    .theme-toggle {
        background: none;
        border: 2px solid var(--header-text);
        color: var(--header-text);
        padding: 6px 12px;
        border-radius: 5px;
        cursor: pointer;
    }
    .container {
        width: 90%;
        max-width: 1200px;
        margin: auto;
        padding: 20px 0;
    }
    section {
        margin-bottom: 50px;
    }
    .plot {
        background: var(--card-bg);
        padding: 15px;
        border-radius: 8px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    .fade-in {
        opacity: 0;
        transform: translateY(20px);
        transition: all 0.6s ease;
    }
    .fade-in.visible {
        opacity: 1;
        transform: translateY(0);
    }
    /* Bird Registration Form */
    .form-card {
        background: var(--card-bg);
        padding: 25px;
        border-radius: 8px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        max-width: 500px;
        margin: auto;
    }
    .form-grid {
        display: grid;
        gap: 15px;
    }
    .form-grid label {
        font-weight: bold;
    }
    .form-grid input, 
    .form-grid select, 
    .form-grid textarea {
        width: 100%;
        padding: 10px;
        border-radius: 5px;
        border: 1px solid #bbb;
        font-size: 1em;
    }
    .form-grid button {
        background: var(--accent);
        color: white;
        padding: 10px;
        border: none;
        border-radius: 5px;
        font-size: 1.1em;
        cursor: pointer;
        transition: background 0.3s;
    }
    .form-grid button:hover {
        background: #e68900;
    }
    /* Registered Birds */
    .bird-cards {
        display: grid;
        gap: 20px;
        margin-top: 20px;
    }
    .bird-card {
        background: var(--card-bg);
        padding: 15px;
        border-radius: 8px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        animation: popIn 0.5s ease forwards;
        opacity: 0;
    }
    @keyframes popIn {
        from { transform: scale(0.8); opacity: 0; }
        to { transform: scale(1); opacity: 1; }
    }
    /* Footer Signature */
    footer {
        text-align: center;
        padding: 15px;
        background: var(--header-bg);
        color: var(--header-text);
        font-weight: bold;
        font-size: 1.1em;
        letter-spacing: 1px;
        animation: glow 2s ease-in-out infinite alternate;
    }
    @keyframes glow {
        from { text-shadow: 0 0 5px var(--accent), 0 0 10px var(--accent); }
        to { text-shadow: 0 0 15px var(--accent), 0 0 30px var(--accent); }
    }
</style>
</head>
<body>

<header>
    <h1>Bird Tracking & Registration</h1>
    <nav>
        <a href="#tracking">Tracking</a>
        <a href="#speed">Speed</a>
        <a href="#register">Register Bird</a>
        <button class="theme-toggle" onclick="toggleTheme()">Toggle Theme</button>
    </nav>
</header>

<div class="container">
    <!-- Bird Tracking -->
    <section id="tracking" class="fade-in">
        <h2>Bird Tracking Visualization</h2>
        <div id="plot_tracking" class="plot"></div>
    </section>

    <!-- Bird Speed -->
    <section id="speed" class="fade-in">
        <h2>Bird Speed Histogram</h2>
        <div id="plot_speed" class="plot"></div>
    </section>

    <!-- Bird Registration Form -->
    <section id="register" class="fade-in">
        <h2>Register a Bird</h2>
        <div class="form-card">
            <form class="form-grid" onsubmit="registerBird(event)">
                <label>Bird Name</label>
                <input type="text" id="birdName" placeholder="Enter bird's name" required>

                <label>Species</label>
                <input type="text" id="species" placeholder="Enter species" required>

                <label>Longitude</label>
                <input type="number" step="0.0001" id="longitude" placeholder="e.g. 3.5" required>

                <label>Latitude</label>
                <input type="number" step="0.0001" id="latitude" placeholder="e.g. 50.1" required>

                <label>Notes</label>
                <textarea id="notes" rows="3" placeholder="Extra info about the bird"></textarea>

                <button type="submit">Submit Registration</button>
            </form>
        </div>
        <div class="bird-cards" id="birdCards"></div>
    </section>
</div>

<!-- Footer -->
<footer>
    Created with ❤️ by Sharmila Fathima
</footer>

<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
<script>
// Load from storage or use default
let trackingData = JSON.parse(localStorage.getItem('birds')) || [
    { bird_name: 'Eric', species: 'Eagle', longitude: [3.5], latitude: [50.1] },
    { bird_name: 'Nico', species: 'Hawk', longitude: [2.5], latitude: [50.2] },
    { bird_name: 'Sanne', species: 'Falcon', longitude: [3.0], latitude: [50.3] }
];

// Render plots
function renderTrackingPlot() {
    const trackingTraces = trackingData.map(bird => ({
        x: bird.longitude,
        y: bird.latitude,
        mode: 'markers',
        type: 'scatter',
        name: bird.bird_name
    }));
    Plotly.newPlot('plot_tracking', trackingTraces, {
        title: 'Bird Tracking Data',
        xaxis: { title: 'Longitude' },
        yaxis: { title: 'Latitude' }
    });
}
function renderSpeedPlot() {
    const ericData = trackingData.filter(b => b.bird_name === 'Eric').map(() => Math.random() * 20);
    Plotly.newPlot('plot_speed', [{
        x: ericData,
        type: 'histogram',
        xbins: { start: 0, end: 30, size: 2 },
        name: 'Eric',
        marker: { color: 'blue', line: { color: 'black', width: 1 } }
    }], {
        title: "Eric's 2D Speed (m/s)",
        xaxis: { title: '2D Speed (m/s)' },
        yaxis: { title: 'Frequency' }
    });
}

// Bird registration
function registerBird(e) {
    e.preventDefault();
    const name = document.getElementById('birdName').value;
    const species = document.getElementById('species').value;
    const lon = parseFloat(document.getElementById('longitude').value);
    const lat = parseFloat(document.getElementById('latitude').value);
    const notes = document.getElementById('notes').value;

    const newBird = { bird_name: name, species, longitude: [lon], latitude: [lat], notes };
    trackingData.push(newBird);
    localStorage.setItem('birds', JSON.stringify(trackingData));

    renderTrackingPlot();
    renderBirdCards();

    confetti({ particleCount: 80, spread: 70, origin: { y: 0.6 } });

    e.target.reset();
    document.getElementById('birdCards').lastElementChild.scrollIntoView({ behavior: 'smooth' });
}

// Render bird cards
function renderBirdCards() {
    const container = document.getElementById('birdCards');
    container.innerHTML = '';
    trackingData.forEach(bird => {
        const card = document.createElement('div');
        card.className = 'bird-card';
        card.innerHTML = `
            <h3>${bird.bird_name} (${bird.species})</h3>
            <p><strong>Location:</strong> ${bird.latitude[0]}, ${bird.longitude[0]}</p>
            <p><em>${bird.notes || 'No additional notes'}</em></p>
        `;
        container.appendChild(card);
    });
}

// Theme toggle
function toggleTheme() {
    document.body.classList.toggle('dark');
}

// Fade-in on scroll
const faders = document.querySelectorAll('.fade-in');
const observer = new IntersectionObserver(entries => {
    entries.forEach(entry => {
        if (entry.isIntersecting) entry.target.classList.add('visible');
    });
}, { threshold: 0.2 });
faders.forEach(fader => observer.observe(fader));

// Init
renderTrackingPlot();
renderSpeedPlot();
renderBirdCards();
</script>
</body>
</html>
